(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{51:function(e,n,t){},52:function(e,n,t){},83:function(e,n){},86:function(e,n,t){},87:function(e,n,t){},88:function(e,n,t){},95:function(e,n,t){"use strict";t.r(n);var c=t(0),r=t(43),a=t.n(r),o=(t(51),t(45)),s=t(2),i=t(9),u=t(97),l=(t(52),t(1)),d=function(e){var n=Object(c.useState)(""),t=Object(i.a)(n,2),r=t[0],a=t[1],o=Object(c.useState)(!1),s=Object(i.a)(o,2),d=s[0],j=s[1],m=Object(c.useState)(!0),b=Object(i.a)(m,2),h=b[0],f=b[1];function O(){var n=Object(u.a)();e.history.push("/room/".concat(n))}function v(){e.history.push("/room/".concat(r))}function p(e){a(e.target.value)}var x=function(){return Object(l.jsxs)("div",{className:"buttons",children:[Object(l.jsx)("button",{className:"create-btn",id:"b1",onClick:O,children:"Create Room"}),Object(l.jsx)("button",{className:"create-btn",onClick:N,children:"Join Room"})]})},g=function(){return Object(l.jsxs)("div",{id:"join-form",children:[Object(l.jsx)("button",{type:"text",className:"join-btn",onClick:C,children:"X"}),Object(l.jsx)("input",{type:"text",className:"join-text",placeholder:"Paste chat ID here",value:r,onChange:p}),Object(l.jsx)("button",{className:"join-btn",onClick:v,children:"Join"})]})},N=function(){j(!0),f(!1)},C=function(){f(!0),j(!1)};return Object(l.jsx)("div",{className:"btn-page",children:Object(l.jsxs)("div",{className:"btn-container",children:[h?Object(l.jsx)(x,{}):null,d?Object(l.jsx)(g,{}):null]})})},j=t(26),m=t(44),b=t.n(m),h=(t(86),function(e){var n=e.messages;return Object(l.jsx)("div",{className:"messages_container",children:n.map((function(e,n){return e.yours?Object(l.jsx)("div",{className:"my_message_container",children:Object(l.jsx)("div",{className:"my_message",children:e.value})},n):Object(l.jsxs)("div",{className:"received_message_container",children:[Object(l.jsx)("div",{className:"received_message",children:e.value}),Object(l.jsx)("div",{id:"usr-r",children:"Username"})]},n)}))})}),f=(t(87),function(e){var n=Object(c.useRef)(),t=Object(c.useRef)(),r=Object(c.useRef)(),a=Object(c.useRef)(),o=Object(c.useState)(""),s=Object(i.a)(o,2),u=s[0],d=s[1],m=Object(c.useState)([]),f=Object(i.a)(m,2),O=f[0],v=f[1];function p(e){v((function(n){return[].concat(Object(j.a)(n),[{yours:!1,value:e.data}])}))}function x(e){var c=new RTCPeerConnection({iceServers:[{urls:"stun:nettverksprogg.eastus2.cloudapp.azure.com:3478"}]});return c.onicecandidate=C,c.onnegotiationneeded=function(){return function(e){n.current.createOffer().then((function(e){return n.current.setLocalDescription(e)})).then((function(){var c={target:e,caller:t.current.id,sdp:n.current.localDescription};t.current.emit("offer",c)})).catch((function(e){return console.log(e)}))}(e)},c}function g(e){n.current=x(),n.current.ondatachannel=function(e){a.current=e.channel,a.current.onmessage=p};var c=new RTCSessionDescription(e.sdp);n.current.setRemoteDescription(c).then((function(){})).then((function(){return n.current.createAnswer()})).then((function(e){return n.current.setLocalDescription(e)})).then((function(){var c={target:e.caller,caller:t.current.id,sdp:n.current.localDescription};t.current.emit("answer",c)}))}function N(e){var t=new RTCSessionDescription(e.sdp);n.current.setRemoteDescription(t).catch((function(e){return console.log(e)}))}function C(e){if(e.candidate){var n={target:r.current,candidate:e.candidate};t.current.emit("ice-candidate",n)}}function w(e){var t=new RTCIceCandidate(e);n.current.addIceCandidate(t).catch((function(e){return console.log(e)}))}function D(){a.current.send(u),v((function(e){return[].concat(Object(j.a)(e),[{yours:!0,value:u}])})),d("")}Object(c.useEffect)((function(){t.current=b.a.connect("https://signaling-server-nettprogg.herokuapp.com/"),t.current.emit("join room",e.match.params.roomID),t.current.on("other user",(function(e){!function(e){n.current=x(e),a.current=n.current.createDataChannel("sendChannel"),a.current.onmessage=p}(e),r.current=e})),t.current.on("user joined",(function(e){r.current=e})),t.current.on("offer",g),t.current.on("answer",N),t.current.on("ice-candidate",w)}),[]);return Object(l.jsxs)("div",{className:"container",children:[Object(l.jsxs)("h1",{children:["Chat ID: ",e.match.params.roomID]}),Object(l.jsxs)("div",{className:"username",children:[Object(l.jsx)("input",{id:"name",type:"text",placeholder:"Username"}),Object(l.jsx)("button",{id:"name-btn",children:"Submit"})]}),Object(l.jsx)(h,{messages:O}),Object(l.jsxs)("div",{className:"send-msg",children:[Object(l.jsx)("textarea",{className:"msg-box",value:u,onChange:function(e){d(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&D()},placeholder:"Write your message here..."}),Object(l.jsx)("button",{className:"btn",onClick:D,children:"Send"})]})]})});t(88);var O=function(){return Object(l.jsx)("div",{className:"App",children:Object(l.jsx)(o.a,{basename:"/STUN-server---IDATT2104-Nettverksprogrammering",children:Object(l.jsxs)(s.c,{children:[Object(l.jsx)(s.a,{path:"/",exact:!0,component:d}),Object(l.jsx)(s.a,{path:"/room/:roomID",component:f})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(Object(l.jsx)(O,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[95,1,2]]]);
//# sourceMappingURL=main.82307592.chunk.js.map